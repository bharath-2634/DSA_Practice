/**
 * Definition for singly-linked list.
 * public class ListNode {
 *     int val;
 *     ListNode next;
 *     ListNode() {}
 *     ListNode(int val) { this.val = val; }
 *     ListNode(int val, ListNode next) { this.val = val; this.next = next; }
 * }
 */

/* 
class Solution {

    public ListNode reverseList(ListNode node) {
        ListNode temp = null;
        ListNode p=node,q=node;

        while(p!=null && q!=null) {
            q = p.next;
            p.next = temp;
            temp = p;
            p= q;
        }

        return temp;
    }

    public void reorderList(ListNode root) {
        ListNode slow = root, fast = root;

        while(fast!=null && fast.next!=null) {
            slow= slow.next;
            fast = fast.next.next;
        }

        ListNode middle = reverseList(slow.next);
        ListNode head = root;
        slow.next = null;

        while(middle!=null) {
            ListNode temp1 = middle.next;
            ListNode temp2 = head.next;

            head.next = middle;
            middle.next = temp2;

            head = temp2;
            middle = temp1;
        } 
    }
}
*/

// This is my second approach using D&C

class Solution {
    ListNode front = null;

    public void reorderList(ListNode root) {
        front = root;
        rearrangeList(root);
    }

    public boolean rearrangeList(ListNode back) {
        if(back==null) return true;

        boolean isEnd = rearrangeList(back.next);
        if(!isEnd) return false;

        if(front==back || front.next==back) {
            back.next = null;
            return false;
        }

        ListNode temp = front.next;
        front.next = back;
        back.next = temp;
        front = temp;

        return true;
    }
}
